(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{6279:(e,t,a)=>{Promise.resolve().then(a.bind(a,8638))},8638:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(5155),l=a(8173),n=a.n(l),r=a(3474),i=a(2115),o=a(8449),u=a(2945);function c(e){let{profile:t}=e,{user:a}=(0,o.A)(),[l,n]=(0,i.useState)(function(){let e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))}()),[r,c]=(0,i.useState)("0"),[d,m]=(0,i.useState)(!1),p=async e=>{if(e.preventDefault(),a){m(!0);try{await (0,u.KC)(a.uid,l,Number(r),t.classRate)}finally{m(!1)}}};return(0,s.jsxs)("section",{className:"rounded-2xl bg-white p-5 shadow-panel",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slateInk",children:"Class Tracking"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Income is auto-added to principal."}),(0,s.jsxs)("form",{onSubmit:p,className:"mt-4 space-y-3",children:[(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Month (YYYY-MM)",(0,s.jsx)("input",{value:l,onChange:e=>n(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Classes in Month",(0,s.jsx)("input",{value:r,onChange:e=>c(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsx)("button",{disabled:d,type:"submit",className:"rounded-xl bg-mint px-4 py-2 text-sm font-medium text-white",children:d?"Saving...":"Save Classes"})]})]})}function d(){let{user:e}=(0,o.A)(),[t,a]=(0,i.useState)(""),[l,n]=(0,i.useState)("General"),[r,c]=(0,i.useState)(new Date().toISOString().slice(0,10)),[d,m]=(0,i.useState)(!1),p=async s=>{if(s.preventDefault(),e){m(!0);try{await (0,u.k5)(e.uid,{amount:Number(t),category:l,dateISO:r}),a("")}finally{m(!1)}}};return(0,s.jsxs)("section",{className:"rounded-2xl bg-white p-5 shadow-panel",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slateInk",children:"Log Expense"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Each expense is permanently stored and deducted from principal."}),(0,s.jsxs)("form",{onSubmit:p,className:"mt-4 space-y-3",children:[(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Amount",(0,s.jsx)("input",{value:t,onChange:e=>a(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Category",(0,s.jsx)("input",{value:l,onChange:e=>n(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Date",(0,s.jsx)("input",{type:"date",value:r,onChange:e=>c(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsx)("button",{disabled:d,type:"submit",className:"rounded-xl bg-ember px-4 py-2 text-sm font-medium text-white",children:d?"Saving...":"Add Expense"})]})]})}function m(e){let{profile:t}=e,{user:a}=(0,o.A)(),[l,n]=(0,i.useState)(function(){let e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))}()),[r,c]=(0,i.useState)(!1),d=async e=>{if(e.preventDefault(),a){c(!0);try{await (0,u.gK)(a.uid,l,t.monthlyInterestRate)}finally{c(!1)}}};return(0,s.jsxs)("section",{className:"rounded-2xl bg-white p-5 shadow-panel",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slateInk",children:"Monthly Interest"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-slate-600",children:"Applied once per month using current principal."}),(0,s.jsxs)("form",{onSubmit:d,className:"mt-4 space-y-3",children:[(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Month (YYYY-MM)",(0,s.jsx)("input",{value:l,onChange:e=>n(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsx)("button",{disabled:r,type:"submit",className:"rounded-xl bg-bankBlue px-4 py-2 text-sm font-medium text-white",children:r?"Applying...":"Apply Interest"})]})]})}function p(e){let{profile:t}=e,{user:a}=(0,o.A)(),[l,n]=(0,i.useState)(t.principal.toString()),[r,c]=(0,i.useState)(t.classRate.toString()),[d,m]=(0,i.useState)(t.monthlyInterestRate.toString()),p=async e=>{e.preventDefault(),a&&await (0,u.mu)(a.uid,{principal:Number(l),classRate:Number(r),monthlyInterestRate:Number(d)})};return(0,s.jsxs)("section",{className:"rounded-2xl bg-white p-5 shadow-panel",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-slateInk",children:"Principal & Rates"}),(0,s.jsxs)("form",{onSubmit:p,className:"mt-4 space-y-3",children:[(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Current Principal",(0,s.jsx)("input",{value:l,onChange:e=>n(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Class Rate",(0,s.jsx)("input",{value:r,onChange:e=>c(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsxs)("label",{className:"block text-sm text-slate-700",children:["Monthly Interest Rate (%)",(0,s.jsx)("input",{value:d,onChange:e=>m(e.target.value),className:"mt-1 w-full rounded-xl border p-2"})]}),(0,s.jsx)("button",{type:"submit",className:"rounded-xl bg-bankBlue px-4 py-2 text-sm font-medium text-white",children:"Save Settings"})]})]})}var x=a(1316);function b(e){let{dashboard:t}=e,a=[{label:"Current Principal",value:(0,x.v)(t.currentPrincipal)},{label:"Total Classes",value:t.totalClasses.toString()},{label:"Class Income",value:(0,x.v)(t.totalClassIncome)},{label:"Interest Earned",value:(0,x.v)(t.totalInterest)},{label:"Expenses",value:(0,x.v)(t.totalExpenses)},{label:"Net Growth",value:(0,x.v)(t.netGrowth)}];return(0,s.jsx)("section",{className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-3",children:a.map(e=>(0,s.jsxs)("article",{className:"rounded-2xl bg-white p-4 shadow-panel",children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:e.label}),(0,s.jsx)("p",{className:"mt-1 text-2xl font-semibold text-slateInk",children:e.value})]},e.label))})}var h=a(5487),g=a(9743);function f(){let{data:e,loading:t,error:a}=function(){let{user:e}=(0,o.A)(),[t,a]=(0,i.useState)(null),[s,l]=(0,i.useState)(!0),[n,r]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(!e){a(null),l(!1);return}return l(!0),r(null),(0,h.NR)(e.uid,e=>{a(e),l(!1)},e=>{r(e.message),l(!1)})},[e]),{data:(0,i.useMemo)(()=>t?{profile:t,dashboard:(0,x.q)(t)}:null,[t]),loading:s,error:n}}();return(0,s.jsx)(r.i,{children:(0,s.jsxs)("main",{className:"mx-auto max-w-6xl p-4 md:p-8",children:[(0,s.jsxs)("header",{className:"mb-6 flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-slateInk md:text-3xl",children:"Dashboard"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n(),{href:"/monthly",className:"w-fit rounded-xl bg-bankBlue px-4 py-2 text-sm font-medium text-white",children:"Monthly View"}),(0,s.jsx)("button",{type:"button",onClick:g.B,className:"rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm",children:"Sign Out"})]})]}),a&&(0,s.jsx)("p",{className:"mb-4 rounded-xl bg-red-50 p-3 text-sm text-red-700",children:a}),t||!e?(0,s.jsx)("p",{className:"text-slate-600",children:"Loading financial data..."}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(b,{dashboard:e.dashboard}),(0,s.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,s.jsx)(p,{profile:e.profile}),(0,s.jsx)(c,{profile:e.profile}),(0,s.jsx)(m,{profile:e.profile}),(0,s.jsx)(d,{})]})]})]})})}},3474:(e,t,a)=>{"use strict";a.d(t,{i:()=>i});var s=a(5155),l=a(2115),n=a(6046),r=a(8449);function i(e){let{children:t}=e,{user:a,loading:i}=(0,r.A)(),o=(0,n.useRouter)();return((0,l.useEffect)(()=>{i||a||o.replace("/signin")},[i,o,a]),i||!a)?(0,s.jsx)("div",{className:"p-6 text-sm text-slate-600",children:"Authenticating..."}):(0,s.jsx)(s.Fragment,{children:t})}},5459:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>u,c:()=>o});var s=a(5155),l=a(2115),n=a(399),r=a(5887),i=a(2945);let o=(0,l.createContext)({user:null,loading:!0});function u(e){let{children:t}=e,[a,u]=(0,l.useState)(null),[c,d]=(0,l.useState)(!0);(0,l.useEffect)(()=>(0,n.hg)(r.j,async e=>{u(e),e&&await (0,i.rZ)(e.uid),d(!1)}),[]);let m=(0,l.useMemo)(()=>({user:a,loading:c}),[c,a]);return(0,s.jsx)(o.Provider,{value:m,children:t})}},8449:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(2115),l=a(5459);function n(){return(0,s.useContext)(l.c)}},1316:(e,t,a)=>{"use strict";function s(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2}).format(e)}function l(e){return{currentPrincipal:e.principal,totalClasses:e.totalClasses,totalClassIncome:e.totalClassIncome,totalInterest:e.totalInterest,totalExpenses:e.totalExpenses,netGrowth:e.principal-e.initialPrincipal}}a.d(t,{q:()=>l,v:()=>s})},2945:(e,t,a)=>{"use strict";a.d(t,{KC:()=>s.KC,gK:()=>s.gK,k5:()=>s.k5,mu:()=>s.mu,rZ:()=>s.rZ});var s=a(5487)},9743:(e,t,a)=>{"use strict";a.d(t,{B:()=>r,G:()=>n});var s=a(399),l=a(5887);async function n(){let e=new s.HF;await (0,s.df)(l.j,e)}async function r(){await (0,s.CI)(l.j)}},5887:(e,t,a)=>{"use strict";a.d(t,{j:()=>i,db:()=>o});var s=a(399),l=a(7058),n=a(9904);let r=(0,n.Dk)().length>0?(0,n.Sx)():(0,n.Wp)({apiKey:"AIzaSyCF7z5BRgDlaCzh9FqmEC4CWJ8JBg4DYmI",authDomain:"moneytracking-1dcdc.firebaseapp.com",projectId:"moneytracking-1dcdc",storageBucket:"moneytracking-1dcdc.firebasestorage.app",messagingSenderId:"755165187671",appId:"1:755165187671:web:a90725c76fb3a807885d12",measurementId:"G-LH2ZR4QFK7"}),i=(0,s.xI)(r),o=(0,l.aU)(r)},5487:(e,t,a)=>{"use strict";a.d(t,{KC:()=>p,NR:()=>c,dW:()=>d,gK:()=>x,k5:()=>b,mu:()=>m,rZ:()=>u});var s=a(7058),l=a(5887);function n(){return new Date().toISOString()}function r(e){return(0,s.H9)(l.db,"users",e,"profile","main")}function i(e,t){return(0,s.H9)(l.db,"users",e,"months",t)}function o(e){var t,a,s,l,r,i,o,u,c,d;return{initialPrincipal:Number(null!==(t=e.initialPrincipal)&&void 0!==t?t:0),principal:Number(null!==(a=e.principal)&&void 0!==a?a:0),classRate:Number(null!==(s=e.classRate)&&void 0!==s?s:500),monthlyInterestRate:Number(null!==(l=e.monthlyInterestRate)&&void 0!==l?l:0),totalClasses:Number(null!==(r=e.totalClasses)&&void 0!==r?r:0),totalClassIncome:Number(null!==(i=e.totalClassIncome)&&void 0!==i?i:0),totalInterest:Number(null!==(o=e.totalInterest)&&void 0!==o?o:0),totalExpenses:Number(null!==(u=e.totalExpenses)&&void 0!==u?u:0),createdAt:String(null!==(c=e.createdAt)&&void 0!==c?c:n()),updatedAt:String(null!==(d=e.updatedAt)&&void 0!==d?d:n())}}async function u(e){let t=r(e);if((await (0,s.x7)(t)).exists())return;let a=n();await (0,s.BN)(t,{initialPrincipal:4e4,principal:4e4,classRate:500,monthlyInterestRate:0,totalClasses:0,totalClassIncome:0,totalInterest:0,totalExpenses:0,createdAt:a,updatedAt:a})}function c(e,t,a){return(0,s.aQ)(r(e),e=>{let a=e.data();a&&t(o(a))},a)}function d(e,t){let a=(0,s.P)((0,s.rJ)(l.db,"users",e,"months"),(0,s.My)("monthKey","desc"));return(0,s.aQ)(a,e=>{t(e.docs.map(e=>{var t,a,s,l,r,i,o,u;let c=e.data();return{monthKey:String(null!==(t=c.monthKey)&&void 0!==t?t:e.id),classesTaken:Number(null!==(a=c.classesTaken)&&void 0!==a?a:0),classIncome:Number(null!==(s=c.classIncome)&&void 0!==s?s:0),interestApplied:!!(null!==(l=c.interestApplied)&&void 0!==l&&l),interestAmount:Number(null!==(r=c.interestAmount)&&void 0!==r?r:0),expenseTotal:Number(null!==(i=c.expenseTotal)&&void 0!==i?i:0),closingPrincipal:Number(null!==(o=c.closingPrincipal)&&void 0!==o?o:0),updatedAt:String(null!==(u=c.updatedAt)&&void 0!==u?u:n())}}))})}async function m(e,t){await (0,s.c4)(l.db,async a=>{let s=r(e),l=await a.get(s);if(!l.exists())throw Error("Profile not found");let i=o(l.data());a.set(s,{...i,...t,updatedAt:n()})})}async function p(e,t,a,u){if(a<0)throw Error("Classes cannot be negative");await (0,s.c4)(l.db,async s=>{var l,c,d,m,p;let x=r(e),b=i(e,t),h=await s.get(x),g=await s.get(b);if(!h.exists())throw Error("Profile not found");let f=o(h.data()),v=null!==(l=g.data())&&void 0!==l?l:{},N=a-Number(null!==(c=v.classesTaken)&&void 0!==c?c:0),w=N*u,y=f.principal+w,j={monthKey:t,classesTaken:a,classIncome:a*u,interestApplied:!!(null!==(d=v.interestApplied)&&void 0!==d&&d),interestAmount:Number(null!==(m=v.interestAmount)&&void 0!==m?m:0),expenseTotal:Number(null!==(p=v.expenseTotal)&&void 0!==p?p:0),closingPrincipal:y,updatedAt:n()};s.set(b,j,{merge:!0}),s.set(x,{...f,principal:y,totalClasses:f.totalClasses+N,totalClassIncome:f.totalClassIncome+w,updatedAt:n()},{merge:!0})})}async function x(e,t,a){await (0,s.c4)(l.db,async u=>{var c,d,m,p,x;let b=r(e),h=i(e,t),g=(0,s.H9)(l.db,"users",e,"interestHistory",t),f=await u.get(b),v=await u.get(h),N=await u.get(g);if(!f.exists())throw Error("Profile not found");if(N.exists())throw Error("Interest already applied for ".concat(t));let w=o(f.data()),y=null!==(c=v.data())&&void 0!==c?c:{};if(null!==(d=y.interestApplied)&&void 0!==d&&d)throw Error("Interest already applied for ".concat(t));let j=w.principal*a/100,I=w.principal+j;u.set(h,{monthKey:t,classesTaken:Number(null!==(m=y.classesTaken)&&void 0!==m?m:0),classIncome:Number(null!==(p=y.classIncome)&&void 0!==p?p:0),interestApplied:!0,interestAmount:j,expenseTotal:Number(null!==(x=y.expenseTotal)&&void 0!==x?x:0),closingPrincipal:I,updatedAt:n()},{merge:!0});let S={monthKey:t,interestAmount:j,appliedAt:n(),rateApplied:a};u.set(g,S),u.set(b,{...w,principal:I,totalInterest:w.totalInterest+j,updatedAt:n()},{merge:!0})})}async function b(e,t){if(t.amount<=0)throw Error("Expense amount must be positive");let a=t.dateISO.slice(0,7);await (0,s.c4)(l.db,async u=>{var c,d,m,p,x,b;let h=r(e),g=i(e,a),f=(0,s.H9)((0,s.rJ)(l.db,"users",e,"expenses")),v=await u.get(h),N=await u.get(g);if(!v.exists())throw Error("Profile not found");let w=o(v.data()),y=null!==(c=N.data())&&void 0!==c?c:{},j=w.principal-t.amount,I={amount:t.amount,category:t.category,dateISO:t.dateISO,monthKey:a,createdAt:n()};u.set(f,{...I,createdAtServer:(0,s.O5)()}),u.set(g,{monthKey:a,classesTaken:Number(null!==(d=y.classesTaken)&&void 0!==d?d:0),classIncome:Number(null!==(m=y.classIncome)&&void 0!==m?m:0),interestApplied:!!(null!==(p=y.interestApplied)&&void 0!==p&&p),interestAmount:Number(null!==(x=y.interestAmount)&&void 0!==x?x:0),expenseTotal:Number(null!==(b=y.expenseTotal)&&void 0!==b?b:0)+t.amount,closingPrincipal:j,updatedAt:n()},{merge:!0}),u.set(h,{...w,principal:j,totalExpenses:w.totalExpenses+t.amount,updatedAt:n()},{merge:!0})})}},6046:(e,t,a)=>{"use strict";var s=a(6658);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[992,138,459,173,441,517,358],()=>t(6279)),_N_E=e.O()}]);