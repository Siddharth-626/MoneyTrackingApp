(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[377],{6434:(e,t,a)=>{Promise.resolve().then(a.bind(a,4197))},4197:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var n=a(5155),s=a(8173),l=a.n(s),r=a(9743);function i(){return(0,n.jsx)("button",{type:"button",onClick:r.G,className:"rounded-xl border border-slate-200 bg-white px-4 py-3 font-medium text-slateInk shadow-sm transition hover:bg-slate-50",children:"Continue with Google"})}var o=a(8449);function d(){let{user:e}=(0,o.A)();return e?(0,n.jsx)("main",{className:"mx-auto flex min-h-screen max-w-3xl items-center justify-center p-6",children:(0,n.jsxs)("div",{className:"w-full rounded-2xl bg-white p-8 shadow-panel",children:[(0,n.jsx)("p",{className:"mb-4 text-slate-700",children:"You are already signed in."}),(0,n.jsx)(l(),{href:"/dashboard",className:"rounded-xl bg-bankBlue px-4 py-2 text-white",children:"Go to Dashboard"})]})}):(0,n.jsx)("main",{className:"mx-auto flex min-h-screen max-w-3xl items-center justify-center p-6",children:(0,n.jsxs)("section",{className:"w-full rounded-2xl bg-white p-8 shadow-panel",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-slateInk",children:"Money Tracking"}),(0,n.jsx)("p",{className:"mt-2 text-slate-600",children:"Track principal, class income, monthly interest, and expenses."}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)(i,{})})]})})}},5459:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>d,c:()=>o});var n=a(5155),s=a(2115),l=a(399),r=a(5887),i=a(2945);let o=(0,s.createContext)({user:null,loading:!0});function d(e){let{children:t}=e,[a,d]=(0,s.useState)(null),[u,c]=(0,s.useState)(!0);(0,s.useEffect)(()=>(0,l.hg)(r.j,async e=>{d(e),e&&await (0,i.rZ)(e.uid),c(!1)}),[]);let m=(0,s.useMemo)(()=>({user:a,loading:u}),[u,a]);return(0,n.jsx)(o.Provider,{value:m,children:t})}},8449:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(2115),s=a(5459);function l(){return(0,n.useContext)(s.c)}},2945:(e,t,a)=>{"use strict";a.d(t,{KC:()=>n.KC,gK:()=>n.gK,k5:()=>n.k5,mu:()=>n.mu,rZ:()=>n.rZ});var n=a(5487)},9743:(e,t,a)=>{"use strict";a.d(t,{B:()=>r,G:()=>l});var n=a(399),s=a(5887);async function l(){let e=new n.HF;await (0,n.df)(s.j,e)}async function r(){await (0,n.CI)(s.j)}},5887:(e,t,a)=>{"use strict";a.d(t,{j:()=>i,db:()=>o});var n=a(399),s=a(7058),l=a(9904);let r=(0,l.Dk)().length>0?(0,l.Sx)():(0,l.Wp)({apiKey:"AIzaSyCF7z5BRgDlaCzh9FqmEC4CWJ8JBg4DYmI",authDomain:"moneytracking-1dcdc.firebaseapp.com",projectId:"moneytracking-1dcdc",storageBucket:"moneytracking-1dcdc.firebasestorage.app",messagingSenderId:"755165187671",appId:"1:755165187671:web:a90725c76fb3a807885d12",measurementId:"G-LH2ZR4QFK7"}),i=(0,n.xI)(r),o=(0,s.aU)(r)},5487:(e,t,a)=>{"use strict";a.d(t,{KC:()=>p,NR:()=>u,dW:()=>c,gK:()=>x,k5:()=>v,mu:()=>m,rZ:()=>d});var n=a(7058),s=a(5887);function l(){return new Date().toISOString()}function r(e){return(0,n.H9)(s.db,"users",e,"profile","main")}function i(e,t){return(0,n.H9)(s.db,"users",e,"months",t)}function o(e){var t,a,n,s,r,i,o,d,u,c;return{initialPrincipal:Number(null!==(t=e.initialPrincipal)&&void 0!==t?t:0),principal:Number(null!==(a=e.principal)&&void 0!==a?a:0),classRate:Number(null!==(n=e.classRate)&&void 0!==n?n:500),monthlyInterestRate:Number(null!==(s=e.monthlyInterestRate)&&void 0!==s?s:0),totalClasses:Number(null!==(r=e.totalClasses)&&void 0!==r?r:0),totalClassIncome:Number(null!==(i=e.totalClassIncome)&&void 0!==i?i:0),totalInterest:Number(null!==(o=e.totalInterest)&&void 0!==o?o:0),totalExpenses:Number(null!==(d=e.totalExpenses)&&void 0!==d?d:0),createdAt:String(null!==(u=e.createdAt)&&void 0!==u?u:l()),updatedAt:String(null!==(c=e.updatedAt)&&void 0!==c?c:l())}}async function d(e){let t=r(e);if((await (0,n.x7)(t)).exists())return;let a=l();await (0,n.BN)(t,{initialPrincipal:4e4,principal:4e4,classRate:500,monthlyInterestRate:0,totalClasses:0,totalClassIncome:0,totalInterest:0,totalExpenses:0,createdAt:a,updatedAt:a})}function u(e,t,a){return(0,n.aQ)(r(e),e=>{let a=e.data();a&&t(o(a))},a)}function c(e,t){let a=(0,n.P)((0,n.rJ)(s.db,"users",e,"months"),(0,n.My)("monthKey","desc"));return(0,n.aQ)(a,e=>{t(e.docs.map(e=>{var t,a,n,s,r,i,o,d;let u=e.data();return{monthKey:String(null!==(t=u.monthKey)&&void 0!==t?t:e.id),classesTaken:Number(null!==(a=u.classesTaken)&&void 0!==a?a:0),classIncome:Number(null!==(n=u.classIncome)&&void 0!==n?n:0),interestApplied:!!(null!==(s=u.interestApplied)&&void 0!==s&&s),interestAmount:Number(null!==(r=u.interestAmount)&&void 0!==r?r:0),expenseTotal:Number(null!==(i=u.expenseTotal)&&void 0!==i?i:0),closingPrincipal:Number(null!==(o=u.closingPrincipal)&&void 0!==o?o:0),updatedAt:String(null!==(d=u.updatedAt)&&void 0!==d?d:l())}}))})}async function m(e,t){await (0,n.c4)(s.db,async a=>{let n=r(e),s=await a.get(n);if(!s.exists())throw Error("Profile not found");let i=o(s.data());a.set(n,{...i,...t,updatedAt:l()})})}async function p(e,t,a,d){if(a<0)throw Error("Classes cannot be negative");await (0,n.c4)(s.db,async n=>{var s,u,c,m,p;let x=r(e),v=i(e,t),b=await n.get(x),f=await n.get(v);if(!b.exists())throw Error("Profile not found");let h=o(b.data()),g=null!==(s=f.data())&&void 0!==s?s:{},w=a-Number(null!==(u=g.classesTaken)&&void 0!==u?u:0),N=w*d,y=h.principal+N,A={monthKey:t,classesTaken:a,classIncome:a*d,interestApplied:!!(null!==(c=g.interestApplied)&&void 0!==c&&c),interestAmount:Number(null!==(m=g.interestAmount)&&void 0!==m?m:0),expenseTotal:Number(null!==(p=g.expenseTotal)&&void 0!==p?p:0),closingPrincipal:y,updatedAt:l()};n.set(v,A,{merge:!0}),n.set(x,{...h,principal:y,totalClasses:h.totalClasses+w,totalClassIncome:h.totalClassIncome+N,updatedAt:l()},{merge:!0})})}async function x(e,t,a){await (0,n.c4)(s.db,async d=>{var u,c,m,p,x;let v=r(e),b=i(e,t),f=(0,n.H9)(s.db,"users",e,"interestHistory",t),h=await d.get(v),g=await d.get(b),w=await d.get(f);if(!h.exists())throw Error("Profile not found");if(w.exists())throw Error("Interest already applied for ".concat(t));let N=o(h.data()),y=null!==(u=g.data())&&void 0!==u?u:{};if(null!==(c=y.interestApplied)&&void 0!==c&&c)throw Error("Interest already applied for ".concat(t));let A=N.principal*a/100,I=N.principal+A;d.set(b,{monthKey:t,classesTaken:Number(null!==(m=y.classesTaken)&&void 0!==m?m:0),classIncome:Number(null!==(p=y.classIncome)&&void 0!==p?p:0),interestApplied:!0,interestAmount:A,expenseTotal:Number(null!==(x=y.expenseTotal)&&void 0!==x?x:0),closingPrincipal:I,updatedAt:l()},{merge:!0});let k={monthKey:t,interestAmount:A,appliedAt:l(),rateApplied:a};d.set(f,k),d.set(v,{...N,principal:I,totalInterest:N.totalInterest+A,updatedAt:l()},{merge:!0})})}async function v(e,t){if(t.amount<=0)throw Error("Expense amount must be positive");let a=t.dateISO.slice(0,7);await (0,n.c4)(s.db,async d=>{var u,c,m,p,x,v;let b=r(e),f=i(e,a),h=(0,n.H9)((0,n.rJ)(s.db,"users",e,"expenses")),g=await d.get(b),w=await d.get(f);if(!g.exists())throw Error("Profile not found");let N=o(g.data()),y=null!==(u=w.data())&&void 0!==u?u:{},A=N.principal-t.amount,I={amount:t.amount,category:t.category,dateISO:t.dateISO,monthKey:a,createdAt:l()};d.set(h,{...I,createdAtServer:(0,n.O5)()}),d.set(f,{monthKey:a,classesTaken:Number(null!==(c=y.classesTaken)&&void 0!==c?c:0),classIncome:Number(null!==(m=y.classIncome)&&void 0!==m?m:0),interestApplied:!!(null!==(p=y.interestApplied)&&void 0!==p&&p),interestAmount:Number(null!==(x=y.interestAmount)&&void 0!==x?x:0),expenseTotal:Number(null!==(v=y.expenseTotal)&&void 0!==v?v:0)+t.amount,closingPrincipal:A,updatedAt:l()},{merge:!0}),d.set(b,{...N,principal:A,totalExpenses:N.totalExpenses+t.amount,updatedAt:l()},{merge:!0})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,138,459,173,441,517,358],()=>t(6434)),_N_E=e.O()}]);